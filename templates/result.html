<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ˆì¸¡ ê²°ê³¼</title>
    <link rel="stylesheet" href="/static/css/style.css" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

</head>
<body>
<!-- ì• ë‹ˆë©”ì´ì…˜ -->
    <div class="pyro">
        <div class="before"></div>
        <div class="after"></div>
    </div>
    <header>
        <h2>ìœ ë…¸ ë†€ì´í„° - ë™ë¬¼í˜• ê²€ì‚¬ê¸°</h2>
    </header>
    <div class="content" id="capture-area">
        <h1>ì˜ˆì¸¡ ê²°ê³¼</h1>

        <div class="image-container">
            <img src="{{ url_for('uploaded_file', filename=image_file) }}" alt="Uploaded Image">
        </div>

        <h2 class="result-text">
            ê°€ì¥ ìœ ì‚¬í•œ ë™ë¬¼ìƒ: {{ predicted_class }}
            <span class="emoji">
                {% if predicted_class == "ê³ ì–‘ì´ìƒ" %}
                    ğŸ˜º
                {% elif predicted_class == "ê°•ì•„ì§€ìƒ" %}
                    ğŸ¶
                {% elif predicted_class == "ì—¬ìš°ìƒ" %}
                    ğŸ¦Š
                {% elif predicted_class == "í† ë¼ìƒ" %}
                    ğŸ°
                {% endif %}
            </span>
        </h2>
        
        {% for i in range(class_names|length) %}
            <div class="skill">
                <div class="skill-name">{{ class_names[i] }}</div>
                <div class="progress-container">
                    <div class="progress-bar" id="progress-{{ i }}"></div>
                    <div class="progress-text">{{ (confidence[i] * 100)|round(2) }}%</div>
                </div>
            </div>
        {% endfor %}

        <button onclick="window.location.href='/'">ë‹¤ë¥¸ ì‚¬ì§„ í•´ë³´ê¸°</button>
        <button onclick="shareWithFriend()">ì¹œêµ¬í•œí…Œ ê³µìœ í•˜ê¸°</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                {% for i in range(class_names|length) %}
                    var bar{{ i }} = document.getElementById('progress-{{ i }}');
                    bar{{ i }}.style.width = '{{ (confidence[i] * 100)|round(2) }}%';
                {% endfor %}
            }, 100);
        });


        window.addEventListener('load', function() {
            var pyro = document.querySelector('.pyro');
            pyro.style.display = 'block';
            setTimeout(function() {
                pyro.style.display = 'none';
            }, 5000);  // 5ì´ˆ í›„ ì• ë‹ˆë©”ì´ì…˜ ìˆ¨ê¹€
        });

        function shareWithFriend() {
    html2canvas(document.querySelector("#capture-area")).then(canvas => {
        // ì´ë¯¸ì§€ë¥¼ Blob í˜•íƒœë¡œ ë³€í™˜
        canvas.toBlob(function(blob) {
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'ì˜ˆì¸¡ê²°ê³¼.png';  // ë‹¤ìš´ë¡œë“œí•  íŒŒì¼ ì´ë¦„
            link.click();  // ë‹¤ìš´ë¡œë“œ ì‹¤í–‰
        });
    });
}
    </script>
</body>
</html>